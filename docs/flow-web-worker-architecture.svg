<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="primary" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#3b82f6" />
      <stop offset="100%" stop-color="#1d4ed8" />
    </linearGradient>
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="0" dy="4" stdDeviation="4" flood-color="#000" flood-opacity="0.25"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" fill="#94a3b8" />
    </marker>
    <marker id="arrowWorker" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" fill="#f59e0b" />
    </marker>
  </defs>

  <rect width="900" height="600" fill="#0f172a" />
  
  <text x="450" y="45" fill="#f8fafc" font-size="28" font-weight="800" text-anchor="middle">Web Worker Offloading Architecture</text>

  <!-- Threads representation -->
  <line x1="250" y1="100" x2="250" y2="550" stroke="#475569" stroke-width="2" stroke-dasharray="8 8" />
  <text x="250" y="90" fill="#cbd5e1" font-size="16" font-weight="600" text-anchor="middle">Main Browser Thread (React)</text>

  <line x1="650" y1="100" x2="650" y2="550" stroke="#f59e0b" stroke-width="2" stroke-dasharray="8 8" />
  <text x="650" y="90" fill="#fcd34d" font-size="16" font-weight="600" text-anchor="middle">Background Web Workers</text>

  <!-- Flow Items -->
  <g filter="url(#shadow)">
    <!-- UI State -->
    <rect x="100" y="150" width="300" height="60" rx="8" fill="#334155" stroke="#3b82f6" stroke-width="2"/>
    <text x="250" y="185" fill="#f8fafc" font-size="16" font-weight="600" text-anchor="middle">User triggers Tournament Generation</text>

    <!-- UI State -->
    <rect x="100" y="270" width="300" height="60" rx="8" fill="#1e293b" />
    <text x="250" y="305" fill="#94a3b8" font-size="14" font-weight="500" text-anchor="middle">UI Remains Unblocked / 60 FPS Animating</text>

    <!-- Worker Processing -->
    <rect x="500" y="210" width="300" height="80" rx="8" fill="#334155" stroke="#f59e0b" stroke-width="2"/>
    <text x="650" y="240" fill="#f8fafc" font-size="16" font-weight="700" text-anchor="middle">Tournament Worker (gameLogic)</text>
    <text x="650" y="265" fill="#cbd5e1" font-size="12" font-weight="500" text-anchor="middle">- Combinatorics &amp; Pool Assignment -</text>
    
    <!-- Returning to Main -->
    <rect x="100" y="380" width="300" height="60" rx="8" fill="#334155" stroke="#3b82f6" stroke-width="2"/>
    <text x="250" y="415" fill="#f8fafc" font-size="16" font-weight="600" text-anchor="middle">React Receives Computed JSON Array</text>

    <!-- Write to Firebase -->
    <rect x="100" y="500" width="300" height="60" rx="8" fill="url(#primary)"/>
    <text x="250" y="535" fill="#ffffff" font-size="16" font-weight="700" text-anchor="middle">Save to Firebase (`patchTournament`)</text>
    
    <!-- Alternative Worker: Standings -->
    <rect x="500" y="440" width="300" height="80" rx="8" fill="#334155" stroke="#f59e0b" stroke-width="2"/>
    <text x="650" y="470" fill="#f8fafc" font-size="16" font-weight="700" text-anchor="middle">Standings Worker</text>
    <text x="650" y="495" fill="#cbd5e1" font-size="12" font-weight="500" text-anchor="middle">- Sorts matrices &amp; breaks head-to-head ties -</text>
  </g>

  <!-- Cross-thread Arrows -->
  <!-- Main to Worker -->
  <path d="M 400 180 L 500 220" stroke="#f59e0b" stroke-width="3" fill="none" marker-end="url(#arrowWorker)"/>
  <rect x="420" y="160" width="60" height="20" rx="4" fill="#0f172a" />
  <text x="450" y="174" fill="#cbd5e1" font-size="10" text-anchor="middle">postMessage</text>

  <!-- Worker to Main -->
  <path d="M 500 270 L 400 395" stroke="#3b82f6" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  <rect x="420" y="340" width="60" height="20" rx="4" fill="#0f172a" />
  <text x="450" y="354" fill="#cbd5e1" font-size="10" text-anchor="middle">onMessage()</text>

  <!-- Downwards React Arrow -->
  <path d="M 250 440 L 250 490" stroke="#94a3b8" stroke-width="3" fill="none" marker-end="url(#arrow)"/>

  <!-- Standings Flow dashed -->
  <path d="M 400 380 L 500 450" stroke="#f59e0b" stroke-width="2" stroke-dasharray="4 4" fill="none" marker-end="url(#arrowWorker)"/>
</svg>
