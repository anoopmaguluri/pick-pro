<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="primary" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#10b981" />
      <stop offset="100%" stop-color="#047857" />
    </linearGradient>
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="0" dy="4" stdDeviation="4" flood-color="#000" flood-opacity="0.25"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" fill="#94a3b8" />
    </marker>
  </defs>

  <rect width="900" height="600" fill="#0f172a" />
  
  <text x="450" y="45" fill="#f8fafc" font-size="28" font-weight="800" text-anchor="middle">PWA Offline Caching &amp; Data Prefetching</text>

  <!-- Connection Boundaries -->
  <rect x="40" y="80" width="820" height="230" rx="8" fill="#1e293b" fill-opacity="0.5" stroke="#3b82f6" stroke-dasharray="4 4" stroke-width="2"/>
  <text x="60" y="110" fill="#3b82f6" font-size="16" font-weight="700">ONLINE PHASE (Bootup &amp; Aggressive Prefetch)</text>

  <rect x="40" y="340" width="820" height="230" rx="8" fill="#1e293b" fill-opacity="0.5" stroke="#f59e0b" stroke-dasharray="4 4" stroke-width="2"/>
  <text x="60" y="370" fill="#f59e0b" font-size="16" font-weight="700">OFFLINE PHASE ("True Offline Reload" Resilience)</text>

  <g filter="url(#shadow)">
    <!-- Boot Actions -->
    <rect x="80" y="140" width="220" height="120" rx="8" fill="#334155" stroke="#3b82f6" stroke-width="2"/>
    <text x="190" y="170" fill="#f8fafc" font-size="16" font-weight="700" text-anchor="middle">React Initial Load</text>
    <circle cx="190" cy="205" r="5" fill="#cbd5e1" />
    <text x="190" y="230" fill="#94a3b8" font-size="12" text-anchor="middle">Downloads App Shell (HTML/JS/CSS)</text>
    
    <rect x="360" y="140" width="220" height="120" rx="8" fill="#334155" stroke="#8b5cf6" stroke-width="2"/>
    <text x="470" y="170" fill="#f8fafc" font-size="16" font-weight="700" text-anchor="middle">useTournaments Hook</text>
    <text x="470" y="195" fill="#cbd5e1" font-size="12" text-anchor="middle">Identifies N Most Recent</text>
    <text x="470" y="215" fill="#eaa" font-size="12" text-anchor="middle">Executes loop over</text>
    <text x="470" y="235" fill="#eaa" font-size="12" font-weight="bold" text-anchor="middle">prefetchTournamentCaches(Ids)</text>
    
    <rect x="640" y="140" width="200" height="120" rx="8" fill="#334155" stroke="#10b981" stroke-width="2"/>
    <text x="740" y="170" fill="#f8fafc" font-size="16" font-weight="700" text-anchor="middle">Firestore Sync</text>
    <text x="740" y="200" fill="#10b981" font-size="12" text-anchor="middle">SDK pulls documents</text>
    <text x="740" y="220" fill="#cbd5e1" font-size="12" text-anchor="middle">Saves matches &amp; subtrees</text>
    <text x="740" y="240" fill="#cbd5e1" font-size="12" text-anchor="middle">to active IndexedDB Cache</text>
    
    <!-- Offline Actions -->
    <rect x="80" y="410" width="220" height="120" rx="8" fill="#334155" stroke="#ef4444" stroke-width="2"/>
    <text x="190" y="440" fill="#f8fafc" font-size="16" font-weight="700" text-anchor="middle">Browser Hard Reload</text>
    <text x="190" y="470" fill="#ef4444" font-size="14" font-weight="bold" text-anchor="middle">Network: Disconnected</text>
    <text x="190" y="490" fill="#cbd5e1" font-size="12" text-anchor="middle">Request intercepted by</text>
    <text x="190" y="510" fill="#cbd5e1" font-size="12" text-anchor="middle">Vite PWA SW (dist/sw.js)</text>
    
    <rect x="360" y="410" width="220" height="120" rx="8" fill="#334155" stroke="#f59e0b" stroke-width="2"/>
    <text x="470" y="440" fill="#f8fafc" font-size="16" font-weight="700" text-anchor="middle">App Shell Served</text>
    <text x="470" y="470" fill="#cbd5e1" font-size="12" text-anchor="middle">React Mounts.</text>
    <text x="470" y="490" fill="#cbd5e1" font-size="12" text-anchor="middle">Components request active</text>
    <text x="470" y="510" fill="#cbd5e1" font-size="12" text-anchor="middle">tournament from Firestore.</text>
    
    <rect x="640" y="410" width="200" height="120" rx="8" fill="url(#primary)"/>
    <text x="740" y="440" fill="#ffffff" font-size="16" font-weight="700" text-anchor="middle">Bypass Network</text>
    <text x="740" y="470" fill="#ffffff" font-size="12" text-anchor="middle">Firestore identifies</text>
    <text x="740" y="490" fill="#ffffff" font-size="12" text-anchor="middle">the offline cache is "hot".</text>
    <text x="740" y="510" fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle">Yields cached docs instantly -> UI</text>
  </g>

  <!-- Arrows Online -->
  <path d="M 300 200 L 350 200" stroke="#94a3b8" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  <path d="M 580 200 L 630 200" stroke="#94a3b8" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Arrows Offline -->
  <path d="M 300 470 L 350 470" stroke="#94a3b8" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  <path d="M 580 470 L 630 470" stroke="#94a3b8" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Vertical Transition -->
  <path d="M 470 270 L 470 330" stroke="#f59e0b" stroke-width="4" fill="none" marker-end="url(#arrow)" stroke-dasharray="6 6"/>
  <rect x="420" y="290" width="100" height="20" rx="4" fill="#0f172a" />
  <text x="470" y="304" fill="#f59e0b" font-size="12" text-anchor="middle">Admin Drives to Park</text>

</svg>
